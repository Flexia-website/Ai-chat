<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Clinton Tech AI · golden touch</title>
  <!-- Font Awesome 6 (free) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: radial-gradient(circle at 10% 30%, #f9eac3, #fcf5e6);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 12px;
    }

    .chat-container {
      width: 100%;
      max-width: 1100px;
      height: 90vh;
      max-height: 850px;
      background: rgba(255, 250, 240, 0.75);
      backdrop-filter: blur(24px);
      -webkit-backdrop-filter: blur(24px);
      border-radius: 42px;
      box-shadow: 0 30px 60px -20px rgba(120, 70, 0, 0.3), inset 0 1px 2px rgba(255, 245, 200, 0.7);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      border: 1px solid rgba(255, 215, 0, 0.25);
    }

    .chat-header {
      background: rgba(70, 50, 20, 0.85);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      color: #fff9e6;
      padding: 18px 26px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 215, 0, 0.4);
    }

    .bot-info {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .bot-avatar {
      width: 48px;
      height: 48px;
      background: linear-gradient(145deg, #f5c542, #b8860b);
      border-radius: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 26px;
      color: #2a1f0c;
      box-shadow: 0 10px 20px -6px rgba(212, 175, 55, 0.5);
    }

    .bot-name {
      font-weight: 650;
      font-size: 1.4rem;
      letter-spacing: -0.4px;
      color: #fff2c0;
    }

    .bot-status {
      font-size: 0.75rem;
      background: #d4a017;
      padding: 5px 12px;
      border-radius: 40px;
      color: #1f1407;
      display: flex;
      align-items: center;
      gap: 5px;
      font-weight: 600;
      backdrop-filter: blur(4px);
      border: 0.5px solid rgba(255, 230, 130, 0.6);
    }

    .chat-messages {
      flex: 1;
      padding: 26px 28px;
      overflow-y: auto;
      background: rgba(250, 240, 220, 0.3);
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    .message {
      max-width: 85%;
      padding: 16px 22px;
      border-radius: 28px;
      line-height: 1.55;
      word-wrap: break-word;
      animation: appear 0.3s ease;
      box-shadow: 0 6px 14px rgba(0,0,0,0.02);
      font-size: 0.98rem;
    }

    @keyframes appear {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .user-message {
      align-self: flex-end;
      background: #4a3720;
      color: #fff2d7;
      border-bottom-right-radius: 8px;
      box-shadow: 0 12px 22px -10px #4a3720cc;
    }

    .bot-message {
      align-self: flex-start;
      background: #fffefae0;
      backdrop-filter: blur(4px);
      color: #2f2a1f;
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-bottom-left-radius: 8px;
      box-shadow: 0 12px 22px -10px rgba(150, 100, 0, 0.2);
    }

    .bot-message strong, .user-message strong {
      font-weight: 700;
    }
    .user-message strong {
      color: #ffdb7c;
    }

    /* Code blocks */
    .code-block-wrapper {
      margin: 16px 0 10px;
      border-radius: 20px;
      background: #2f2a1f;
      overflow: hidden;
      box-shadow: 0 12px 28px rgba(0,0,0,0.3);
      border: 1px solid #a67c1e;
    }

    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 18px;
      background: #594e2c;
      color: #f7eac6;
      font-size: 0.85rem;
      border-bottom: 1px solid #a67c1e;
    }

    .code-actions {
      display: flex;
      gap: 12px;
    }

    .code-actions button {
      background: none;
      border: none;
      color: #f7eac6;
      cursor: pointer;
      font-size: 0.9rem;
      padding: 5px 8px;
      border-radius: 8px;
      transition: all 0.15s;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .code-actions button:hover {
      background: #7e6a35;
      color: white;
    }

    .code-block {
      padding: 18px;
      overflow-x: auto;
      background: #2f2a1f;
      color: #f7f0d9;
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      font-size: 0.9rem;
      line-height: 1.6;
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Typing indicator */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 16px 22px;
      background: #fffef2;
      border-radius: 36px;
      border-bottom-left-radius: 8px;
      width: fit-content;
      border: 1px solid rgba(212, 175, 55, 0.2);
      box-shadow: 0 8px 16px -12px #3a2e1a;
    }
    .typing-indicator span {
      width: 9px;
      height: 9px;
      background: #c9a03d;
      border-radius: 50%;
      display: inline-block;
      opacity: 0.6;
      animation: bounce 1.3s infinite ease-in-out;
    }
    .typing-indicator span:nth-child(1) { animation-delay: 0s; }
    .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
    .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes bounce {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.6; }
      30% { transform: translateY(-12px); opacity: 1; }
    }

    /* Input area */
    .chat-input-area {
      display: flex;
      padding: 18px 26px;
      background: rgba(255, 245, 220, 0.6);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-top: 1px solid rgba(212, 175, 55, 0.2);
      gap: 14px;
    }

    .input-wrapper {
      flex: 1;
      display: flex;
      background: white;
      border-radius: 60px;
      padding: 5px 5px 5px 22px;
      border: 1px solid rgba(180, 130, 30, 0.15);
      box-shadow: 0 10px 20px -12px #7e5f2a;
      transition: all 0.2s;
    }
    .input-wrapper:focus-within {
      border-color: #b8860b;
      box-shadow: 0 10px 24px -10px #b8860b;
    }
    #userInput {
      flex: 1;
      border: none;
      padding: 14px 0;
      font-size: 1rem;
      background: transparent;
      outline: none;
      font-family: inherit;
    }

    /* Perfect circle send button */
    #sendBtn {
      background: #b8860b;
      color: #1f1407;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      aspect-ratio: 1/1;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 1.4rem;
      box-shadow: 0 12px 22px -10px #b37b2e;
      padding: 0;
    }
    #sendBtn:hover {
      background: #dba432;
      transform: scale(1.05);
      color: #2a1f0c;
    }
    #sendBtn i {
      line-height: 1;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(6px);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal.active {
      display: flex;
    }
    .modal-content {
      background: #fffbf0;
      width: 90%;
      max-width: 1000px;
      height: 80%;
      border-radius: 28px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 40px 70px -20px #3a2e1a;
      border: 1px solid #e0b354;
    }
    .modal-header {
      padding: 18px 24px;
      background: #7e632a;
      color: #fff2c0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .modal-header h3 {
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .close-modal {
      background: none;
      border: none;
      color: #fff2c0;
      font-size: 2rem;
      cursor: pointer;
      line-height: 1;
    }
    .modal-body {
      flex: 1;
      background: #fcf2de;
    }
    #previewFrame {
      width: 100%;
      height: 100%;
      border: none;
      background: white;
    }

    /* ===== RESPONSIVE ENHANCEMENTS ===== */
    @media (max-width: 768px) {
      .chat-header {
        padding: 14px 20px;
      }
      .bot-avatar {
        width: 42px;
        height: 42px;
        font-size: 22px;
      }
      .bot-name {
        font-size: 1.2rem;
      }
      .bot-status {
        font-size: 0.7rem;
        padding: 4px 10px;
      }
      .chat-messages {
        padding: 20px 22px;
      }
      .message {
        max-width: 90%;
        padding: 14px 18px;
        font-size: 0.95rem;
      }
      .chat-input-area {
        padding: 14px 20px;
        gap: 12px;
      }
      #userInput {
        padding: 12px 0;
        font-size: 0.95rem;
      }
      #sendBtn {
        width: 48px;
        height: 48px;
        font-size: 1.2rem;
      }
      .code-header {
        padding: 8px 14px;
        font-size: 0.8rem;
      }
      .code-actions button {
        padding: 4px 6px;
        font-size: 0.8rem;
      }
      .code-block {
        padding: 14px;
        font-size: 0.85rem;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 8px;
      }
      .chat-container {
        border-radius: 32px;
      }
      .chat-header {
        padding: 12px 16px;
      }
      .bot-info {
        gap: 10px;
      }
      .bot-avatar {
        width: 38px;
        height: 38px;
        font-size: 20px;
        border-radius: 14px;
      }
      .bot-name {
        font-size: 1.1rem;
      }
      .bot-status {
        font-size: 0.65rem;
        padding: 3px 8px;
      }
      .chat-messages {
        padding: 16px 16px;
        gap: 14px;
      }
      .message {
        max-width: 98%;
        padding: 12px 16px;
        font-size: 0.9rem;
      }
      .chat-input-area {
        padding: 12px 16px;
        gap: 10px;
      }
      .input-wrapper {
        padding-left: 16px;
      }
      #userInput {
        padding: 10px 0;
        font-size: 0.9rem;
      }
      #sendBtn {
        width: 44px;
        height: 44px;
        font-size: 1.1rem;
      }
      .code-block-wrapper {
        margin: 12px 0 8px;
        border-radius: 16px;
      }
      .code-header {
        padding: 6px 12px;
      }
      .code-actions {
        gap: 6px;
      }
      .code-actions button {
        padding: 4px 5px;
        font-size: 0.75rem;
      }
      .code-actions button span {
        display: none; /* hide text on very small, keep icons */
      }
      .code-actions button i {
        margin: 0;
      }
      .code-block {
        padding: 12px;
        font-size: 0.8rem;
      }
      .modal-content {
        width: 95%;
        height: 85%;
        border-radius: 22px;
      }
      .modal-header {
        padding: 14px 18px;
      }
      .modal-header h3 {
        font-size: 1rem;
      }
      .close-modal {
        font-size: 1.8rem;
      }
    }

    @media (max-width: 360px) {
      .chat-header {
        padding: 10px 12px;
      }
      .bot-avatar {
        width: 34px;
        height: 34px;
        font-size: 18px;
      }
      .bot-name {
        font-size: 1rem;
      }
      .bot-status {
        padding: 2px 6px;
      }
      .chat-input-area {
        padding: 10px 12px;
      }
      #sendBtn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="chat-container">
    <div class="chat-header">
      <div class="bot-info">
        <div class="bot-avatar">
          <i class="fas fa-crown"></i>
        </div>
        <div>
          <div class="bot-name">Clinton Tech AI</div>
          <div class="bot-status">
            <i class="fas fa-circle"></i> personal
          </div>
        </div>
      </div>
      <div style="color: rgba(255, 235, 150, 0.8); font-size: 1.3rem;">
        <i class="fas fa-sliders-h"></i>
      </div>
    </div>

    <div class="chat-messages" id="chatMessages"></div>

    <div class="chat-input-area">
      <div class="input-wrapper">
        <input type="text" id="userInput" placeholder="Ask me anything..." autocomplete="off">
      </div>
      <button id="sendBtn" aria-label="Send message">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>

  <!-- Preview Modal -->
  <div class="modal" id="previewModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-eye"></i> HTML Preview</h3>
        <button class="close-modal" id="closeModalBtn">&times;</button>
      </div>
      <div class="modal-body">
        <iframe id="previewFrame" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
      </div>
    </div>
  </div>

  <script>
    // API key (replace with your own)
    const API_KEY = 'AIzaSyD1PS21YAO4l_UIMRVQDE8-A44siMuMfjM';
    const MODEL = 'gemini-2.5-flash';

    const chatMessages = document.getElementById('chatMessages');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const previewModal = document.getElementById('previewModal');
    const previewFrame = document.getElementById('previewFrame');
    const closeModalBtn = document.getElementById('closeModalBtn');

    closeModalBtn.addEventListener('click', () => {
      previewModal.classList.remove('active');
      previewFrame.srcdoc = '';
    });
    window.addEventListener('click', (e) => {
      if (e.target === previewModal) {
        previewModal.classList.remove('active');
        previewFrame.srcdoc = '';
      }
    });

    // Escape HTML special chars
    function escapeHtml(unsafe) {
      return unsafe.replace(/[&<>"]/g, (m) => {
        if (m === '&') return '&amp;';
        if (m === '<') return '&lt;';
        if (m === '>') return '&gt;';
        if (m === '"') return '&quot;';
        return m;
      });
    }

    // Parse bot message: extract code blocks, add interactive buttons (copy & preview only)
    function parseMessage(text) {
      const codeBlockRegex = /```(\w*)\n([\s\S]*?)```/g;
      const blocks = [];
      let match;
      let lastIndex = 0;
      let parts = [];

      while ((match = codeBlockRegex.exec(text)) !== null) {
        const before = text.slice(lastIndex, match.index);
        parts.push({ type: 'text', content: before });
        const lang = match[1] || 'plaintext';
        const code = match[2];
        blocks.push({ lang, code });
        parts.push({ type: 'code', index: blocks.length - 1 });
        lastIndex = match.index + match[0].length;
      }
      if (lastIndex < text.length) {
        parts.push({ type: 'text', content: text.slice(lastIndex) });
      }

      let html = '';
      for (let part of parts) {
        if (part.type === 'text') {
          let escaped = escapeHtml(part.content);
          escaped = escaped.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
          html += escaped;
        } else {
          const block = blocks[part.index];
          const lang = block.lang;
          const code = block.code;
          const codeForDisplay = escapeHtml(code);

          html += `
            <div class="code-block-wrapper" data-code="${encodeURIComponent(code)}">
              <div class="code-header">
                <span><i class="fas fa-code"></i> ${lang}</span>
                <div class="code-actions">
                  ${lang.toLowerCase() === 'html' ? `<button class="preview-btn" title="Preview HTML"><i class="fas fa-eye"></i><span> Preview</span></button>` : ''}
                  <button class="copy-btn" title="Copy to clipboard"><i class="fas fa-copy"></i><span> Copy</span></button>
                </div>
              </div>
              <div class="code-block">
                <code>${codeForDisplay}</code>
              </div>
            </div>
          `;
        }
      }
      return html;
    }

    function addMessage(text, sender) {
      const msgDiv = document.createElement('div');
      msgDiv.classList.add('message', sender === 'user' ? 'user-message' : 'bot-message');

      if (sender === 'user') {
        msgDiv.innerHTML = escapeHtml(text).replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
      } else {
        msgDiv.innerHTML = parseMessage(text);
      }

      chatMessages.appendChild(msgDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;

      // Attach event listeners to buttons (copy and preview only)
      if (sender === 'bot') {
        // Copy buttons
        msgDiv.querySelectorAll('.copy-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const wrapper = btn.closest('.code-block-wrapper');
            const code = decodeURIComponent(wrapper.dataset.code);
            navigator.clipboard.writeText(code).then(() => {
              const original = btn.innerHTML;
              btn.innerHTML = '<i class="fas fa-check"></i><span> Copied!</span>';
              setTimeout(() => { btn.innerHTML = original; }, 2000);
            }).catch(() => alert('Failed to copy.'));
          });
        });

        // Preview buttons (HTML only)
        msgDiv.querySelectorAll('.preview-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const wrapper = btn.closest('.code-block-wrapper');
            const code = decodeURIComponent(wrapper.dataset.code);
            previewFrame.srcdoc = code;
            previewModal.classList.add('active');
          });
        });
      }
    }

    // Simple function to call API (no Google mention)
    async function getBotResponse(userMessage) {
      const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL}:generateContent?key=${API_KEY}`;

      const systemInstruction = {
        parts: [{ text: "You are Clinton Tech AI, a warm and helpful technical assistant. When showing code, use triple backticks with the language (e.g., ```html ... ```). You can use **bold** for emphasis. Keep responses clear and friendly." }]
      };

      const requestBody = {
        contents: [
          {
            role: "user",
            parts: [{ text: userMessage }]
          }
        ],
        systemInstruction: systemInstruction
      };

      try {
        const response = await fetch(url, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(requestBody)
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.error?.message || `HTTP error ${response.status}`);
        }

        const data = await response.json();
        const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I couldn't process that.";
        return botReply;
      } catch (error) {
        console.error('API error:', error); // console only – no user-facing reference
        // Return a generic error message without mentioning Google or Gemini
        return "I'm having trouble connecting right now. Please try again later.";
      }
    }

    function showTypingIndicator() {
      const indicator = document.createElement('div');
      indicator.classList.add('typing-indicator');
      indicator.id = 'typingIndicator';
      indicator.innerHTML = '<span></span><span></span><span></span>';
      chatMessages.appendChild(indicator);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function removeTypingIndicator() {
      const indicator = document.getElementById('typingIndicator');
      if (indicator) indicator.remove();
    }

    async function handleSend() {
      const message = userInput.value.trim();
      if (!message) return;

      userInput.disabled = true;
      sendBtn.disabled = true;

      addMessage(message, 'user');
      userInput.value = '';

      showTypingIndicator();

      const reply = await getBotResponse(message);

      removeTypingIndicator();
      addMessage(reply, 'bot');

      userInput.disabled = false;
      sendBtn.disabled = false;
      userInput.focus();
    }

    sendBtn.addEventListener('click', handleSend);
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleSend();
    });

    // Welcome message with updated name
    addMessage("Hello! I'm **Clinton Tech AI**, your personal coding companion with a golden heart. ✨ I can help you write, explain, and preview code. Try me — paste any code or ask a question!", 'bot');
  </script>
</body>
</html>
